@startuml Concept Diagram - ECS Architecture (Complete)

!theme plain
skinparam backgroundColor #FFFFFF
skinparam componentStyle rectangle
skinparam linetype ortho

title Game Engine - Concept Architecture (ECS Pattern - Complete)

package "Concept Layer" {
    rectangle "World\n(Điều phối)" as WorldConcept #LightBlue
    
    package "System Types" {
        rectangle "System\n(Xử lý Components)" as SystemComponent #LightGreen
        rectangle "System\n(Utility/Service)" as SystemUtility #LightCyan
        rectangle "System\n(Điều khiển Entity)" as SystemEntity #LightSalmon
    }
    
    rectangle "Entity\n(Container)" as EntityConcept #LightYellow
    
    package "Component Types" {
        rectangle "Component\n(Có System)" as ComponentWithSystem #LightCoral
        rectangle "Component\n(Độc lập)" as ComponentStandalone #LightPink
    }
}

' Relationships
WorldConcept --> SystemComponent : "quản lý\n(manages)"
WorldConcept --> SystemUtility : "quản lý\n(manages)"
WorldConcept --> SystemEntity : "quản lý\n(manages)"

SystemComponent --> EntityConcept : "xử lý\n(processes)"
SystemComponent --> ComponentWithSystem : "xử lý\n(processes)"

SystemEntity --> EntityConcept : "điều khiển\n(controls)"

EntityConcept --> ComponentWithSystem : "chứa\n(contains)"
EntityConcept --> ComponentStandalone : "chứa\n(contains)"

ComponentWithSystem --> SystemComponent : "đăng ký\n(registers)"

EntityConcept --> SystemEntity : "yêu cầu\n(request)"

ComponentWithSystem ..> SystemUtility : "sử dụng\n(uses)"
ComponentStandalone ..> SystemUtility : "sử dụng\n(uses)"
EntityConcept ..> SystemUtility : "sử dụng\n(uses)"

note top of WorldConcept
  **World - Điều phối viên**
  - Quản lý game loop
  - Điều phối tất cả systems
  - Update/Render cycle
end note

note right of SystemComponent
  **System - Xử lý Components**
  - Xử lý entities/components
  - Logic nghiệp vụ chuyên biệt
  - Ví dụ: BehaviourSystem, Physic2DSystem
  - Update mỗi frame
end note

note right of SystemUtility
  **System - Utility/Service**
  - Cung cấp services/utilities
  - Không xử lý components trực tiếp
  - Ví dụ: InputSystem, AudioSystem
  - Có thể được sử dụng bởi Components
end note

note right of SystemEntity
  **System - Điều khiển Entity**
  - Quản lý lifecycle của Entity
  - Xử lý deferred operations
  - Ví dụ: DestroySystem, SpawnSystem
  - Xử lý vào cuối frame
end note

note bottom of EntityConcept
  **Entity - Container**
  - Chứa các components
  - Quản lý lifecycle
  - Trạng thái active/inactive
  - Có thể yêu cầu destroy/spawn
end note

note left of ComponentWithSystem
  **Component - Có System**
  - Đăng ký với Systems
  - Được xử lý bởi Systems
  - Ví dụ: Behaviour, Collider2D
end note

note left of ComponentStandalone
  **Component - Độc lập**
  - Không đăng ký với Systems
  - Tự quản lý logic
  - Ví dụ: SpriteRenderer, Transform2D
end note

@enduml


